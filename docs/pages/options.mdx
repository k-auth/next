# 옵션

K-Auth provider의 모든 설정 옵션입니다.

import { Callout } from 'nextra/components'

## 카카오 옵션

```typescript
KAuth({
  kakao: {
    // 필수
    clientId: string,
    clientSecret: string,

    // 수집 옵션 (선택)
    collect: {
      email: boolean,     // 이메일
      profile: boolean,   // 닉네임, 프로필 이미지
      phone: boolean,     // 전화번호
      birthday: boolean,  // 생년월일
      gender: boolean,    // 성별
      ageRange: boolean,  // 연령대
      ci: boolean,        // CI (카카오싱크 비즈니스 전용)
    },
  },
});
```

### 옵션 상세

| 옵션 | 타입 | 기본값 | 설명 |
|------|------|--------|------|
| `clientId` | `string` | - | 카카오 REST API 키 **(필수)** |
| `clientSecret` | `string` | - | 카카오 Client Secret **(필수)** |
| `collect.email` | `boolean` | `false` | 이메일 수집 (scope: `account_email`) |
| `collect.profile` | `boolean` | `false` | 프로필 수집 (scope: `profile_nickname`, `profile_image`) |
| `collect.phone` | `boolean` | `false` | 전화번호 수집 (scope: `phone_number`) |
| `collect.birthday` | `boolean` | `false` | 생년월일 수집 (scope: `birthday`, `birthyear`) |
| `collect.gender` | `boolean` | `false` | 성별 수집 (scope: `gender`) |
| `collect.ageRange` | `boolean` | `false` | 연령대 수집 (scope: `age_range`) |
| `collect.ci` | `boolean` | `false` | CI 수집 (scope: `account_ci`) - 비즈니스 전용 |

### 사용 예시

```typescript
KAuth({
  kakao: {
    clientId: process.env.KAKAO_CLIENT_ID!,
    clientSecret: process.env.KAKAO_CLIENT_SECRET!,
    collect: {
      email: true,     // → scope에 account_email 추가
      profile: true,   // → scope에 profile_nickname, profile_image 추가
      phone: true,     // → scope에 phone_number 추가
      birthday: true,  // → scope에 birthday, birthyear 추가
    },
  },
});
```

<Callout type="warning">
추가 정보를 수집하려면 카카오 개발자센터에서 해당 동의 항목을 먼저 활성화해야 합니다.
</Callout>

## 네이버 옵션

```typescript
KAuth({
  naver: {
    // 필수
    clientId: string,
    clientSecret: string,

    // 수집 옵션 (문서화 목적)
    collect: {
      email: boolean,     // 이메일
      profile: boolean,   // 별명, 프로필 사진
      phone: boolean,     // 전화번호
      birthday: boolean,  // 생년월일
      gender: boolean,    // 성별
      ageRange: boolean,  // 연령대
      name: boolean,      // 실명
    },
  },
});
```

### 옵션 상세

| 옵션 | 타입 | 기본값 | 설명 |
|------|------|--------|------|
| `clientId` | `string` | - | 네이버 Client ID **(필수)** |
| `clientSecret` | `string` | - | 네이버 Client Secret **(필수)** |
| `collect.*` | `boolean` | `false` | 문서화 목적 (실제 동작 안 함) |

<Callout type="warning">
**중요: 네이버는 OAuth scope을 지원하지 않습니다.**

K-Auth의 `collect` 옵션은 코드에서 실제로 동작하지 않으며, 어떤 정보를 수집할 것인지 문서화 목적으로만 제공됩니다. 실제 동의 항목은 [네이버 개발자센터](https://developers.naver.com/apps)에서 **제공 정보 선택**을 직접 설정해야 합니다.
</Callout>

## 구글 옵션

```typescript
KAuth({
  google: {
    // 필수
    clientId: string,
    clientSecret: string,

    // 수집 옵션 (선택)
    collect: {
      email: boolean,    // 이메일
      profile: boolean,  // 이름, 프로필 사진
    },

    // 고급 옵션
    forceConsent: boolean,  // 매번 동의 화면 표시
  },
});
```

### 옵션 상세

| 옵션 | 타입 | 기본값 | 설명 |
|------|------|--------|------|
| `clientId` | `string` | - | 구글 Client ID **(필수)** |
| `clientSecret` | `string` | - | 구글 Client Secret **(필수)** |
| `collect.email` | `boolean` | `false` | 이메일 수집 |
| `collect.profile` | `boolean` | `false` | 프로필(이름, 사진) 수집 |
| `forceConsent` | `boolean` | `false` | 매번 동의 화면 표시 |

### forceConsent 옵션

`forceConsent: true`로 설정하면:
- 매번 사용자에게 동의 화면이 표시됩니다
- `refresh_token`을 항상 받을 수 있습니다 (`access_type: offline`)
- 토큰 갱신이 필요한 백엔드 작업에 유용합니다

```typescript
KAuth({
  google: {
    clientId: process.env.GOOGLE_CLIENT_ID!,
    clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    collect: { email: true, profile: true },
    forceConsent: true,  // refresh_token 필요 시
  },
});
```

## 애플 옵션

```typescript
KAuth({
  apple: {
    // 필수
    clientId: string,
    clientSecret: string,

    // 수집 옵션 (선택)
    collect: {
      email: boolean,  // 이메일
      name: boolean,   // 이름
    },
  },
});
```

### 옵션 상세

| 옵션 | 타입 | 기본값 | 설명 |
|------|------|--------|------|
| `clientId` | `string` | - | 애플 Services ID **(필수)** |
| `clientSecret` | `string` | - | 애플 Client Secret JWT **(필수)** |
| `collect.email` | `boolean` | `false` | 이메일 수집 |
| `collect.name` | `boolean` | `false` | 이름 수집 |

### 애플 주의사항

<Callout type="info">
- 애플은 **최초 로그인 시에만** 사용자 이름을 제공합니다
- 이후 로그인에서는 이름이 전달되지 않으므로 DB에 저장이 필요합니다
- `clientSecret`은 Apple Developer Console에서 생성한 JWT입니다
- 애플 로그인은 **HTTPS가 필수**입니다 (localhost에서 테스트 어려움)
</Callout>

## 전체 설정 예시

```typescript
import { KAuth } from '@k-auth/next';

export const { handlers, auth, signIn, signOut } = KAuth({
  kakao: {
    clientId: process.env.KAKAO_CLIENT_ID!,
    clientSecret: process.env.KAKAO_CLIENT_SECRET!,
    collect: {
      email: true,
      profile: true,
      phone: true,
      birthday: true,
      gender: true,
    },
  },
  naver: {
    clientId: process.env.NAVER_CLIENT_ID!,
    clientSecret: process.env.NAVER_CLIENT_SECRET!,
    // 네이버 개발자센터에서 직접 설정
  },
  google: {
    clientId: process.env.GOOGLE_CLIENT_ID!,
    clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    collect: { email: true, profile: true },
    forceConsent: true,
  },
  apple: {
    clientId: process.env.APPLE_CLIENT_ID!,
    clientSecret: process.env.APPLE_CLIENT_SECRET!,
    collect: { email: true, name: true },
  },
});
```

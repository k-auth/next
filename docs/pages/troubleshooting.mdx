# 문제 해결

자주 발생하는 문제와 해결 방법입니다.

## 설정 관련

### AUTH_SECRET이 설정되지 않았습니다

```
[next-auth] ERROR: `AUTH_SECRET` is missing
```

`.env.local`에 `AUTH_SECRET`을 추가하세요:

```bash
openssl rand -base64 32
```

생성된 값을 환경 변수에 추가:

```env
AUTH_SECRET=생성된_값
```

### clientId 또는 clientSecret이 없습니다

```
[K-Auth 오류] MISSING_CLIENT_ID
```

환경 변수가 제대로 설정되어 있는지 확인하세요:

```env
KAKAO_CLIENT_ID=your_kakao_rest_api_key
KAKAO_CLIENT_SECRET=your_kakao_client_secret
```

`.env.local` 파일이 `.gitignore`에 포함되어 있는지도 확인하세요.

## 카카오 관련

### Redirect URI가 등록되지 않았습니다

```
KOE006: Redirect URI가 등록되지 않았습니다
```

1. [Kakao Developers](https://developers.kakao.com) 접속
2. **카카오 로그인** → **Redirect URI**
3. URI 추가: `http://localhost:3000/api/auth/callback/kakao`

import { Callout } from 'nextra/components'

<Callout type="warning">
개발용과 배포용 URI를 모두 등록해야 합니다.
</Callout>

### 동의 항목이 비활성화되어 있습니다

```
[K-Auth 오류] KAKAO_PHONE_NOT_ENABLED
```

1. [Kakao Developers](https://developers.kakao.com) 접속
2. **동의항목** 메뉴
3. 필요한 항목(전화번호 등) 활성화
4. **동의 단계**를 `필수 동의` 또는 `선택 동의`로 설정

### Client Secret이 활성화되지 않았습니다

1. [Kakao Developers](https://developers.kakao.com) 접속
2. **보안** 메뉴
3. **활성화 상태**를 `사용함`으로 변경

## 네이버 관련

### Callback URL이 일치하지 않습니다

1. [NAVER Developers](https://developers.naver.com) 접속
2. **API 설정** 탭
3. **Callback URL**에 `http://localhost:3000/api/auth/callback/naver` 추가

### 서비스 URL 오류

네이버는 서비스 URL 검증이 엄격합니다:
- 개발: `http://localhost:3000`
- 배포: `https://yourdomain.com` (프로토콜 포함)

## 배포 관련

### 배포 후 로그인이 안 됩니다

체크리스트:

1. **환경 변수 확인**
   - `AUTH_SECRET` 설정됨
   - `KAKAO_CLIENT_ID`, `KAKAO_CLIENT_SECRET` 등 설정됨

2. **Redirect URI 등록**
   - 카카오: `https://yourdomain.com/api/auth/callback/kakao`
   - 네이버: `https://yourdomain.com/api/auth/callback/naver`

3. **네이버 서비스 URL**
   - `https://yourdomain.com`으로 변경

4. **HTTPS 확인**
   - 배포 환경에서는 HTTPS 필수

### Vercel 배포 시 환경 변수

Vercel Dashboard에서 환경 변수를 설정하세요:
1. Project Settings → Environment Variables
2. 필요한 변수 모두 추가

## 버튼 관련

### 버튼 스타일이 적용되지 않습니다

K-Auth 버튼은 inline styles를 사용합니다. CSS 우선순위 문제가 있다면 `!important`를 사용하세요:

```tsx
<Button.Kakao className="!w-full" />
```

### 다크 모드에서 버튼이 이상합니다

버튼은 각 서비스 가이드라인에 따라 고정 색상을 사용합니다. 다크 모드에서도 동일한 색상으로 표시됩니다.

## 그 외

### 세션이 유지되지 않습니다

1. `AUTH_SECRET`이 배포 환경에서 설정되어 있는지 확인
2. 쿠키 설정 확인 (HTTPS에서는 secure 쿠키 필요)

### TypeScript 타입 에러

타입 확장이 필요하면 `types/next-auth.d.ts` 파일을 생성하세요:

```typescript
import 'next-auth';

declare module 'next-auth' {
  interface Session {
    user: {
      id: string;
      // 추가 필드
    } & DefaultSession['user'];
  }
}
```

---

문제가 해결되지 않으면 [GitHub Issues](https://github.com/k-auth/next/issues)에 문의해주세요.
